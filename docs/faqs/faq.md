# FAQs

## Accounts/Password/OTP

??? question "(OTP) How can I resolve the IPA command error when getting OTP?"

    This error occurs when the credentials issued by your authentication system, which are valid for one day, expire or become invalid. Here are the steps to resolve this problem. 
    
    Open your login terminal and execute the following command to obtain new credentials.
    
    ```bash
    $> kinit
    Password for [UserID]@SDFARM.KR: (Enter your password)
    ```

    Enter your password and press Enter to generate new credentials. Now, re-run the `ipa otptoken-add` command. It should execute without errors, using the newly generated credentials.

??? question "(OTP) How can I resolve `Unable to display QR code` error?"

    When connecting to the GSDC login server via a lab workstation/desktop using the GNOME Terminal in a Linux system (e.g., Ubuntu), executing the `ipa otptoken-add` command results in the message `ipa: WARNING: Unable to display QR code using the configured output encoding. Please use the token URI to configure your OTP device`.

    To resolve this issue, you can force the use of a locale supported by the internal Python QR code package within the ipa tool. Use the following command:
    
    ```bash
    $> LANG=en_US.UTF-8 LC_ALL=en_US.UTF-8 ipa otptoken-add --algo=sha512
    ```

??? question "(LOCK+OTP) Releasing screen lock"

    When the screen lock is activated while using OTP, it prompts for a password with a message like :

    ```bash
    Screen used by [UserName] <[UserID]> on [LoginServerName].
    Password:
    ```

    ```bash
    This tty (pts/1) is not a virtual console.

    The pts/1 is now locked by [UserID].
    Password: 
    ```

    What password should I use to unlock it? To unlock the screen in this scenario, you should enter both the `First Factor` (usually your regular password string) and the `Second Factor` (the 6 digits OTP code generated by your OTP token). Combining these two factors (with consequtive password + otp) will allow you to unlock the screen and continue using your session.


## SSH Login/Terminal

## X11 Forwarding

## SSH Tunnelling

## Data Transfer

## CryoSPARC

??? question "How to change CryoSPARC's master host name?"

    CryoSPARC master daemons have been executed on ScientificLinux7.x(EL7)-based login servers (__`tem-ui-el7.sdfarm.kr`__ and __`tem-cs-el7.sdfarm.kr`__) using `cryosparcm start` command for the representative account of each research group. 
    
    During OS upgrades to AlmaLinux 9.x, all these login servers hostname has been changed. 
    Thus, {==CryoSPARC master configuration must be changed in order to ensure normal execution on the new login servers.
    (__`tem-ui-al9.sdfarm.kr`__ and __`tem-cs-al9.sdfarm.kr`__)==} 
    
    === "Old EL7-based login servers (config.sh)"
        ``` yaml
        ...
        export CRYOSPARC_MASTER_HOSTNAME="tem-ui-el7.sdfarm.kr"
        ...
        ```
        or
        ``` yaml
        ...
        export CRYOSPARC_MASTER_HOSTNAME="tem-cs-el7.sdfarm.kr"
        ...
        ```
    === "New AL9-based login servers (config.sh)"
        ``` yaml
        ...
        export CRYOSPARC_MASTER_HOSTNAME="tem-ui-al9.sdfarm.kr"
        ...
        ```
        or
        ``` yaml
        ...
        export CRYOSPARC_MASTER_HOSTNAME="tem-cs-al9.sdfarm.kr"
        ...
        ```

    1. Log-in old login servers (__`tem-ui-el7`__ or __`tem-cs-el7`__) using each group's representative account. Stop all the cryosparc daemons.
        - `$> cryosparcm stop` 
        - `$> ps aux | grep <AccountName> | grep cryosparc`
        - `$> ps aux | grep <AccountName> | grep -E "cryosparc|node" | awk '{print $2}' | xargs -I{} kill -9 {}`   
    2. Locate `/tem/scratch/<GroupDir>/.cryosparc/cryosparc_master`, edit `config.sh` file and save (see above codeblock). 
    3. Log-in new login servers (__`tem-ui-al9`__ or __`tem-cs-al9`__) using the same account. Start cryosparc.
        - `$> cat /tem/scratch/<GroupDir>/.cryosparc/cryosparc_master/config.sh`
        - `$> cryosparcm start`


??? question "How to migrate CryoSPARC's `TEM-FARM` lane from old EL7 to new AL9-based cluster?"

    `TEM-FARM` lane information (stored in Cryosparc database) needs to be updated mainly due to the difference between Torque and PBSPro batch systems. Lane info


    ```yaml
    a text
    ```

    ```yaml
    b text
    ```
